# セッションハイジャックツール

指定したWEBサーバーに対してセッションハイジャックを実行し、SECRET_KEYを辞書攻撃で見つけるPythonツールです。

## 注意事項

⚠️ **このツールは教育目的および許可された環境でのみ使用してください。**
- 許可されていないサーバーに対する攻撃は違法です
- 自分のサーバーやCTF（Capture The Flag）などの許可された環境でのみ使用してください

## インストール

```bash
pip install -r requirements.txt
```

## 主な機能

### 1. SECRET_KEYの辞書攻撃
- デフォルトのSECRET_KEY候補リストを使用した自動攻撃
- カスタム辞書ファイルの読み込み対応
- マルチスレッドによる高速な辞書攻撃
- セッションクッキーからSECRET_KEYを推測

### 2. セッションクッキーの取得と解析
- ターゲットサーバーからセッションクッキーを自動取得
- Flask/Djangoのセッションクッキー形式に対応
- セッションクッキーの復号と内容の表示

### 3. セッションデータの偽造
- `_user_id`, `_fresh`, `_id`を含むセッションデータの生成
- 指定したユーザーIDでのセッション偽造
- SECRET_KEYを使用した署名付きセッションクッキーの生成

### 4. 複数エンドポイントへのアクセステスト
- デフォルトで`/profile`, `/cart`, `/orders`にアクセス
- カスタムエンドポイントの指定が可能
- 各エンドポイントへのアクセス結果を詳細に表示
- 認証バイパスの成功/失敗を判定

### 5. 詳細なログ出力
- 各ステップの進行状況を表示
- セッションデータの内容をJSON形式で表示
- 生成されたセッションクッキーの表示
- 各エンドポイントへのアクセス結果を表示

## 使用方法

### 基本的な使用方法

```bash
python session_hijack.py -u http://localhost:5000
```

### カスタム辞書ファイルを使用

```bash
python session_hijack.py -u http://localhost:5000 -w wordlist.txt
```

### 特定のユーザーIDを指定

```bash
python session_hijack.py -u http://localhost:5000 --user-id 1
```

### カスタムエンドポイントを指定

```bash
python session_hijack.py -u http://localhost:5000 --endpoints /profile /cart /orders
```

### スレッド数を指定

```bash
python session_hijack.py -u http://localhost:5000 --threads 20
```

## オプション

- `-u, --url`: ターゲットURL（必須）
- `-w, --wordlist`: SECRET_KEYの辞書ファイルパス（オプション）
- `--user-id`: ハイジャックするユーザーID（オプション、デフォルト: 1）
- `--endpoints`: テストするエンドポイントのリスト（オプション、デフォルト: /profile /cart /orders）
- `--threads`: 辞書攻撃のスレッド数（オプション、デフォルト: 10）

## 動作原理

1. **セッションクッキーの取得**: ターゲットURLにリクエストを送信し、セッションクッキーを取得
2. **SECRET_KEYの辞書攻撃**: 辞書ファイルまたはデフォルトリストを使用してSECRET_KEYを推測（マルチスレッド対応）
3. **セッションクッキーの復号**: 見つけたSECRET_KEYを使用してセッションクッキーを復号し、内容を確認
4. **セッションデータの偽造**: `_user_id`, `_fresh`, `_id`を含む偽造セッションデータを生成
5. **偽造クッキーの生成**: SECRET_KEYを使用して署名付きのセッションクッキーを生成
6. **複数エンドポイントへのアクセス**: 偽造したセッションクッキーを使用して、指定したエンドポイントに順次アクセス
7. **結果の判定**: 各エンドポイントへのアクセス結果を判定し、認証バイパスの成功/失敗を報告

## 対応フレームワーク

- Flask（主に対応）
- Django（一部対応）

## 辞書ファイルの形式

辞書ファイルは1行に1つのSECRET_KEY候補を記述してください：

```
secret
SECRET
secretkey
changeme
...
```

## ライセンス

教育目的のみ。使用は自己責任でお願いします。

